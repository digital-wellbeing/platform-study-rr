<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Study 2: Gaming and Sleep</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="3_sleep_files/libs/clipboard/clipboard.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/quarto.js"></script>
<script src="3_sleep_files/libs/quarto-html/popper.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/anchor.min.js"></script>
<link href="3_sleep_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="3_sleep_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="3_sleep_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="3_sleep_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="3_sleep_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Study 2: Gaming and Sleep</h1>
</div>



<div class="quarto-title-meta column-page">

    
  
    
  </div>
  


</header>


<section id="study-2-gaming-and-sleep" class="level1">
<h1>Study 2: Gaming and Sleep</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse, lme4, marginaleffects, glmmTMB, mice, ordinal, modelsummary, lubridate, mctq)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>studyStartDate <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(<span class="st">"2024-05-01 00:00:00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data.diary &lt;- read_csv("data-synthetic/synDiaryClean.csv") # requires that the preprocessing script has been run</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.diary &lt;- readRDS("data-synthetic/synDiaryClean.rds") # requires that the preprocessing script has been run</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data.intake <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synIntake.rds"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data.nin <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synNintendo.rds"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data.xbox <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synXbox.rds"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>data.steam <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synSteam.rds"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.android &lt;- readRDS("data-synthetic/synAndroid.rds")</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># data.ios &lt;- readRDS("data-synthetic/syniOS.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.nin.custom <span class="ot">&lt;-</span> data.nin <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionEnd =</span> sessionStart <span class="sc">+</span> <span class="fu">minutes</span>(<span class="fu">as.integer</span>(duration)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data.steam.custom <span class="ot">&lt;-</span> data.steam <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionStart =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(date, hour), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H"</span>), </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sessionEnd =</span> sessionStart<span class="sc">+</span><span class="fu">minutes</span>(<span class="fu">as.integer</span>(minutes)))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>data.xbox.custom <span class="ot">&lt;-</span> data.xbox <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionEnd =</span> sessionStart <span class="sc">+</span> <span class="fu">minutes</span>(<span class="fu">as.integer</span>(duration)))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># going to ignore iOS for this study due to lack of temporal resolution</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data.android.custom &lt;- data.android %&gt;% filter(category == "Games") %&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(time = sessionStart, sessionStart = ymd_hms(paste(date, sessionStart)), sessionEnd = sessionStart+minutes(as.integer(duration))) %&gt;% mutate(platform="Android")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">latenight =</span> <span class="fu">ifelse</span>(<span class="fu">hour</span>(sessionStart) <span class="sc">&gt;=</span> <span class="dv">23</span> <span class="sc">|</span> <span class="fu">hour</span>(sessionStart) <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, latenight, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(latenight <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: make sure psqi_4#1_1_* have reasonable values in panel_balanced</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the minimum and maximum values of the column</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># min_val &lt;- min(panel_balanced$`psqi_4#1_1_1`, na.rm = TRUE)</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># max_val &lt;- max(panel_balanced$`psqi_4#1_1_1`, na.rm = TRUE)</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rescale the values to be between 0 and 12</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># panel_balanced$`psqi_4#1_1_1` &lt;- (panel_balanced$`psqi_4#1_1_1` - min_val) / (max_val - min_val) * 12</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate the minimum and maximum values of the column</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># min_val &lt;- min(panel_balanced$`psqi_4#1_1_2`, na.rm = TRUE)</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co"># max_val &lt;- max(panel_balanced$`psqi_4#1_1_2`, na.rm = TRUE)</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rescale the values to be between 0 and 12</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="co"># panel_balanced$`psqi_4#1_1_2` &lt;- (panel_balanced$`psqi_4#1_1_2` - min_val) / (max_val - min_val) * 60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="h1" class="level1">
<h1>H1</h1>
<section id="h1a-late-night-gaming-is-associated-with-poorer-sleep-quality." class="level2">
<h2 class="anchored" data-anchor-id="h1a-late-night-gaming-is-associated-with-poorer-sleep-quality.">H1a: Late-night gaming is associated with poorer sleep quality.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_6 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, psqi_6) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For psqi_6 1 means Very good, 2 means Fairly good, 3 means Fairly bad, 4 means Very bad</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a  <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_6_ord =</span> <span class="fu">factor</span>(psqi_6, <span class="at">ordered =</span> <span class="cn">TRUE</span>),  <span class="co"># Convert psqi_6 to an ordered factor</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with rescaled covariates</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>model.h1a <span class="ot">&lt;-</span> <span class="fu">clmm</span>(psqi_6_ord <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>gender),</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data.gaming.latenight.h1a)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1a</span><span class="st">`</span> <span class="ot">=</span> model.h1a),</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_9j623r742h1u5bjv5uk2(i, j, css_id) {
        var table = document.getElementById("tinytable_9j623r742h1u5bjv5uk2");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_9j623r742h1u5bjv5uk2');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_9j623r742h1u5bjv5uk2(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_9j623r742h1u5bjv5uk2");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(0, 0, 'tinytable_css_id3yecggg7e2pycyjz8373') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(0, 1, 'tinytable_css_id0av47mll04v5i7er9sw6') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(1, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(1, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(2, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(2, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(3, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(3, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(4, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(4, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(5, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(5, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(6, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(6, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(7, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(7, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(8, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(8, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(9, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(9, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(10, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(10, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(11, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(11, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(12, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(12, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(13, 0, 'tinytable_css_idxoxcgnhulrvxi9qh43e9') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(13, 1, 'tinytable_css_id7p2y37ttrpzt9fa0wibu') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(14, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(14, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(15, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(15, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(16, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(16, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(17, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(17, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(18, 0, 'tinytable_css_idm2m36zd79cm2w27msqro') })
window.addEventListener('load', function () { styleCell_9j623r742h1u5bjv5uk2(18, 1, 'tinytable_css_id310snkm4414pvlvxf2kk') })
    </script>

    <style>
    .table td.tinytable_css_id3yecggg7e2pycyjz8373, .table th.tinytable_css_id3yecggg7e2pycyjz8373 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id0av47mll04v5i7er9sw6, .table th.tinytable_css_id0av47mll04v5i7er9sw6 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idm2m36zd79cm2w27msqro, .table th.tinytable_css_idm2m36zd79cm2w27msqro {  text-align: left; }
    .table td.tinytable_css_id310snkm4414pvlvxf2kk, .table th.tinytable_css_id310snkm4414pvlvxf2kk {  text-align: center; }
    .table td.tinytable_css_idxoxcgnhulrvxi9qh43e9, .table th.tinytable_css_idxoxcgnhulrvxi9qh43e9 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id7p2y37ttrpzt9fa0wibu, .table th.tinytable_css_id7p2y37ttrpzt9fa0wibu {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_9j623r742h1u5bjv5uk2" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1a</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1|2                                           </td>
                  <td>-1.50  </td>
                </tr>
                <tr>
                  <td>2|3                                           </td>
                  <td>-0.09  </td>
                </tr>
                <tr>
                  <td>3|4                                           </td>
                  <td>1.30   </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>-0.01  </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.13  </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>0.07   </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.04  </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.06  </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.10  </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.17   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>-1.00  </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.93   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5605   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.006  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>15078.6</td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>15164.8</td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.42   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1b-late-night-gaming-is-associated-with-shorter-sleep-duration." class="level2">
<h2 class="anchored" data-anchor-id="h1b-late-night-gaming-is-associated-with-shorter-sleep-duration.">H1b: Late-night gaming is associated with shorter sleep duration.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert and compute</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_1_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_1</span><span class="st">`</span>), <span class="co"># Convert hours to numeric</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_2_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_2</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">60</span>, <span class="co"># Convert minutes to numeric hours</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_hours_sleep =</span> psqi_4_1_1_1_hours <span class="sc">+</span> psqi_4_1_1_2_hours, <span class="co"># Compute total hours of sleep</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, total_hours_sleep) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b  <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>model.h1b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(total_hours_sleep <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) <span class="sc">+</span> isWeekend, <span class="at">data =</span> data.gaming.latenight.h1b )</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1b</span><span class="st">`</span> <span class="ot">=</span> model.h1b),</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_znoqnbku58lj3uebq2gr(i, j, css_id) {
        var table = document.getElementById("tinytable_znoqnbku58lj3uebq2gr");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_znoqnbku58lj3uebq2gr');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_znoqnbku58lj3uebq2gr(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_znoqnbku58lj3uebq2gr");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(0, 0, 'tinytable_css_idd3aa9clbi8xgpjhsxdqb') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(0, 1, 'tinytable_css_idqx1b4tpwldquwd693fax') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(1, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(1, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(2, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(2, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(3, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(3, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(4, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(4, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(5, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(5, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(6, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(6, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(7, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(7, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(8, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(8, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(9, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(9, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(10, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(10, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(11, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(11, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(12, 0, 'tinytable_css_idbys6w94tlzj2rcb65etn') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(12, 1, 'tinytable_css_idcaavqiah96d7is6xdkpc') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(13, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(13, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(14, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(14, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(15, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(15, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(16, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(16, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(17, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(17, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(18, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(18, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(19, 0, 'tinytable_css_id02wl4jfdwz29t153nlni') })
window.addEventListener('load', function () { styleCell_znoqnbku58lj3uebq2gr(19, 1, 'tinytable_css_id3mebngh8x8rpw9y0u1rs') })
    </script>

    <style>
    .table td.tinytable_css_idd3aa9clbi8xgpjhsxdqb, .table th.tinytable_css_idd3aa9clbi8xgpjhsxdqb {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idqx1b4tpwldquwd693fax, .table th.tinytable_css_idqx1b4tpwldquwd693fax {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id02wl4jfdwz29t153nlni, .table th.tinytable_css_id02wl4jfdwz29t153nlni {  text-align: left; }
    .table td.tinytable_css_id3mebngh8x8rpw9y0u1rs, .table th.tinytable_css_id3mebngh8x8rpw9y0u1rs {  text-align: center; }
    .table td.tinytable_css_idbys6w94tlzj2rcb65etn, .table th.tinytable_css_idbys6w94tlzj2rcb65etn {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idcaavqiah96d7is6xdkpc, .table th.tinytable_css_idcaavqiah96d7is6xdkpc {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_znoqnbku58lj3uebq2gr" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1b</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>6.57 [6.24, 6.90]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.00 [-0.01, 0.01]  </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.07 [-0.24, 0.11] </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.03 [-0.16, 0.10] </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.07 [-0.20, 0.06] </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.30 [-0.66, 0.05]+</td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>0.01 [-0.17, 0.18]  </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.99                </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00                </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>0.99                </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.22                </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.92                </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5605                </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.001               </td>
                </tr>
                <tr>
                  <td>R2 Cond.                                      </td>
                  <td>0.322               </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>29412.5             </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>29492.1             </td>
                </tr>
                <tr>
                  <td>ICC                                           </td>
                  <td>0.3                 </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.67                </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1c-late-night-gaming-is-associated-with-lower-well-being." class="level2">
<h2 class="anchored" data-anchor-id="h1c-late-night-gaming-is-associated-with-lower-well-being.">H1c: Late-night gaming is associated with lower well-being.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">latenight =</span> <span class="fu">ifelse</span>(<span class="fu">hour</span>(sessionStart) <span class="sc">&gt;=</span> <span class="dv">23</span> <span class="sc">|</span> <span class="fu">hour</span>(sessionStart) <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>data.gaming.h1c <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define biweekly waves (14-day intervals) that end at day 84</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">14</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">42</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">43</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Assign NA for days beyond 84</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.h1c <span class="sc">%&gt;%</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, latenight, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">biweekly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">14</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(latenight <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1 - None of the time"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2 - Rarely"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3 - Some of the time"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4 - Often"</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5 - All of the time"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>wemwbs_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wemwbs_1"</span>, <span class="st">"wemwbs_2"</span>, <span class="st">"wemwbs_3"</span>, <span class="st">"wemwbs_4"</span>, <span class="st">"wemwbs_5"</span>, <span class="st">"wemwbs_6"</span>, <span class="st">"wemwbs_7"</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(wemwbs_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a wemwbs_total score for panel_balanced</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span>  data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wemwbs_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(wemwbs_columns)))) </span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, wemwbs_total) <span class="sc">%&gt;%</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight.h1c, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span> </span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c  <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>model.h1c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wemwbs_total <span class="sc">~</span> biweekly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> biweekly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) <span class="sc">+</span> isWeekend, <span class="at">data =</span> data.gaming.latenight.h1c )</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1c</span><span class="st">`</span> <span class="ot">=</span> model.h1c),</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_l9k2mq0vd40upnlfpnd8(i, j, css_id) {
        var table = document.getElementById("tinytable_l9k2mq0vd40upnlfpnd8");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_l9k2mq0vd40upnlfpnd8');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_l9k2mq0vd40upnlfpnd8(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_l9k2mq0vd40upnlfpnd8");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(0, 0, 'tinytable_css_idlfcgax9485rmag6xggg1') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(0, 1, 'tinytable_css_idsfsizb605mw4i389jvs3') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(1, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(1, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(2, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(2, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(3, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(3, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(4, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(4, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(5, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(5, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(6, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(6, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(7, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(7, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(8, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(8, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(9, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(9, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(10, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(10, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(11, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(11, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(12, 0, 'tinytable_css_id69vmqxp1e7pbscnc6ofw') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(12, 1, 'tinytable_css_iddqmt3x4wv8mxhc51xcx8') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(13, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(13, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(14, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(14, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(15, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(15, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(16, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(16, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(17, 0, 'tinytable_css_id92poye1evmjwy2vo70u5') })
window.addEventListener('load', function () { styleCell_l9k2mq0vd40upnlfpnd8(17, 1, 'tinytable_css_idv3jl13krdp2ksw9mxfhk') })
    </script>

    <style>
    .table td.tinytable_css_idlfcgax9485rmag6xggg1, .table th.tinytable_css_idlfcgax9485rmag6xggg1 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idsfsizb605mw4i389jvs3, .table th.tinytable_css_idsfsizb605mw4i389jvs3 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id92poye1evmjwy2vo70u5, .table th.tinytable_css_id92poye1evmjwy2vo70u5 {  text-align: left; }
    .table td.tinytable_css_idv3jl13krdp2ksw9mxfhk, .table th.tinytable_css_idv3jl13krdp2ksw9mxfhk {  text-align: center; }
    .table td.tinytable_css_id69vmqxp1e7pbscnc6ofw, .table th.tinytable_css_id69vmqxp1e7pbscnc6ofw {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_iddqmt3x4wv8mxhc51xcx8, .table th.tinytable_css_iddqmt3x4wv8mxhc51xcx8 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_l9k2mq0vd40upnlfpnd8" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1c</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                    </td>
                  <td>21.15 [18.20, 24.10]***</td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played                    </td>
                  <td>0.00 [-0.01, 0.00]     </td>
                </tr>
                <tr>
                  <td>age_scaled                                     </td>
                  <td>0.00 [-0.13, 0.13]     </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                     </td>
                  <td>0.03 [-0.06, 0.12]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                               </td>
                  <td>0.00 [-0.09, 0.10]     </td>
                </tr>
                <tr>
                  <td>regionUS                                       </td>
                  <td>-0.13 [-0.39, 0.14]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                      </td>
                  <td>-0.01 [-0.16, 0.13]    </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                             </td>
                  <td>1.29                   </td>
                </tr>
                <tr>
                  <td>SD (biweekly_avg_minutes_played pid)           </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~biweekly_avg_minutes_played pid)</td>
                  <td>-1.00                  </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                          </td>
                  <td>3.36                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                              </td>
                  <td>3.49                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                       </td>
                  <td>9875                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                       </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>AIC                                            </td>
                  <td>53698.3                </td>
                </tr>
                <tr>
                  <td>BIC                                            </td>
                  <td>53784.7                </td>
                </tr>
                <tr>
                  <td>RMSE                                           </td>
                  <td>3.37                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1d-late-night-gaming-is-associated-with-higher-daytime-sleepiness." class="level2">
<h2 class="anchored" data-anchor-id="h1d-late-night-gaming-is-associated-with-higher-daytime-sleepiness.">H1d: Late-night gaming is associated with higher daytime sleepiness.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">latenight =</span> <span class="fu">ifelse</span>(<span class="fu">hour</span>(sessionStart) <span class="sc">&gt;=</span> <span class="dv">23</span> <span class="sc">|</span> <span class="fu">hour</span>(sessionStart) <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, latenight, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(latenight <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No chance of dozing"</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Slight chance of dozing"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moderate chance of dozing"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High chance of dozing"</span> <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>eps_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^eps"</span>, <span class="fu">names</span>(data.panel), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(eps_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a eps_total score for panel_balanced</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eps_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(data.panel.custom, eps_columns)))</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, eps_total) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span> </span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d  <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>model.h1d <span class="ot">&lt;-</span> <span class="fu">lmer</span>(eps_total <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h1d )</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1d</span><span class="st">`</span> <span class="ot">=</span> model.h1d),</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_fy8l4tljr8dznsz49zak(i, j, css_id) {
        var table = document.getElementById("tinytable_fy8l4tljr8dznsz49zak");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_fy8l4tljr8dznsz49zak');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_fy8l4tljr8dznsz49zak(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_fy8l4tljr8dznsz49zak");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(0, 0, 'tinytable_css_idsdx71gc1li5diasbx7mq') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(0, 1, 'tinytable_css_idpaxmeo94pd6kxu68j3b6') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(1, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(1, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(2, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(2, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(3, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(3, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(4, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(4, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(5, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(5, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(6, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(6, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(7, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(7, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(8, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(8, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(9, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(9, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(10, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(10, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(11, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(11, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(12, 0, 'tinytable_css_idlp9jqzkld25hw3emyzow') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(12, 1, 'tinytable_css_idt2h0r1ttcykzk2ujehnn') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(13, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(13, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(14, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(14, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(15, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(15, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(16, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(16, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(17, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(17, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(18, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(18, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(19, 0, 'tinytable_css_idky3jli1xeb1rqa1ergnp') })
window.addEventListener('load', function () { styleCell_fy8l4tljr8dznsz49zak(19, 1, 'tinytable_css_iddl7kjkwji98yni7ec56f') })
    </script>

    <style>
    .table td.tinytable_css_idsdx71gc1li5diasbx7mq, .table th.tinytable_css_idsdx71gc1li5diasbx7mq {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idpaxmeo94pd6kxu68j3b6, .table th.tinytable_css_idpaxmeo94pd6kxu68j3b6 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idky3jli1xeb1rqa1ergnp, .table th.tinytable_css_idky3jli1xeb1rqa1ergnp {  text-align: left; }
    .table td.tinytable_css_iddl7kjkwji98yni7ec56f, .table th.tinytable_css_iddl7kjkwji98yni7ec56f {  text-align: center; }
    .table td.tinytable_css_idlp9jqzkld25hw3emyzow, .table th.tinytable_css_idlp9jqzkld25hw3emyzow {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idt2h0r1ttcykzk2ujehnn, .table th.tinytable_css_idt2h0r1ttcykzk2ujehnn {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_fy8l4tljr8dznsz49zak" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1d</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>12.02 [11.77, 12.26]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>-0.01 [-0.02, 0.00]+   </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.01 [-0.17, 0.15]    </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.06 [-0.17, 0.05]    </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.03 [-0.15, 0.09]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.05 [-0.21, 0.12]    </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>0.02 [-0.30, 0.34]     </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.64                   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.01                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>1.00                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.04                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.77                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5605                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>R2 Cond.                                      </td>
                  <td>0.280                  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>28678.9                </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>28758.5                </td>
                </tr>
                <tr>
                  <td>ICC                                           </td>
                  <td>0.3                    </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.56                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
</section>
<section id="h2" class="level1">
<h1>H2</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_1 to work  and turn it into a logical variable where 1 is 1 and 2 is 0, other is NA</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">work =</span> <span class="fu">ifelse</span>(mctq_1 <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_1 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_2 to "wd" </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">wd =</span> mctq_2_1, <span class="at">bt_w =</span> mctq_3_1, <span class="at">sprep_w =</span> mctq_3_3, <span class="at">slat_w =</span> mctq_3_4, <span class="at">se_w =</span> mctq_3_5, <span class="at">si_w =</span> mctq_3_6)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Yes/No in mctq_4_1 to logical</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alarm_w =</span> <span class="fu">ifelse</span>(mctq_4_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_4_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert  Yes/No in mctq_5_1 to logical and name it wake_before_w</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">wake_before_w =</span> <span class="fu">ifelse</span>(mctq_5_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_5_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">bt_f =</span> mctq_6_1, <span class="at">sprep_f =</span> mctq_6_3, <span class="at">slat_f =</span> mctq_6_4, <span class="at">se_f =</span> mctq_6_5, <span class="at">si_f =</span> mctq_6_6)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Yes/No in mctq_7_1 to logical</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alarm_f =</span> <span class="fu">ifelse</span>(mctq_7_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_7_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">reasons_f =</span> <span class="fu">ifelse</span>(mctq_7_2 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_7_2 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_8_1 to "reasons_why_f"</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">reasons_why_f =</span> mctq_8_1)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="st">"wd"</span>, as.integer),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^work$|^alarm_|^wake_|^reasons_f$"</span>),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                as.logical),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^bt_|^sprep_|^se_"</span>), hms<span class="sc">::</span>parse_hm),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^slat_|^si_"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> lubridate<span class="sc">::</span><span class="fu">dminutes</span>(<span class="fu">as.numeric</span>(.x)))</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for participants who have completed the MCTQ</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work))</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Sleep onset</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>so_w <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">so</span>(data.panel.custom<span class="sc">$</span>sprep_w, data.panel.custom<span class="sc">$</span>slat_w)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>so_f <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">so</span>(data.panel.custom<span class="sc">$</span>sprep_f, data.panel.custom<span class="sc">$</span>slat_f)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Sleep duration</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_w <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sdu</span>(data.panel.custom<span class="sc">$</span>so_w, data.panel.custom<span class="sc">$</span>se_w)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_f <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sdu</span>(data.panel.custom<span class="sc">$</span>so_f, data.panel.custom<span class="sc">$</span>se_f)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Midsleep time</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msw <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msl</span>(data.panel.custom<span class="sc">$</span>so_w, data.panel.custom<span class="sc">$</span>sd_w)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msf <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msl</span>(data.panel.custom<span class="sc">$</span>so_f, data.panel.custom<span class="sc">$</span>sd_f)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Weekly sleep duration</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_week <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sd_week</span>(data.panel.custom<span class="sc">$</span>sd_w, data.panel.custom<span class="sc">$</span>sd_f, data.panel.custom<span class="sc">$</span>wd)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Chronotype</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Chronotype or sleep-corrected local time of mid-sleep on work-free days</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co"># msf_sc() allows you to compute the chronotype, or corrected local time of mid-sleep on work-free days. It takes five arguments: msf (local time of mid-sleep on work-free days), sd_w (sleep duration on workdays), sd_f (sleep duration on work-free days), sd_week(average weekly sleep duration), and alarm_f (a logical object indicating if the respondent uses an alarm clock to wake up on work-free days).</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co"># If sd_f is less or equal than sd_w, the output must be msf. Else, it must return msf minus the difference between sd_f and sd_week divided by 2. msf_sc can only be computed if alarm_f is equal to FALSE (the function will return NA when alarm_f == TRUE).</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co"># msf_sc applies a correction to msf, removing an estimation of the effect from accumulated sleep debt on workdays that usually is compensated on work-free days. See ?msf_sc to learn more.</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msf_sc <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msf_sc</span>(data.panel.custom<span class="sc">$</span>msf, data.panel.custom<span class="sc">$</span>sd_w, data.panel.custom<span class="sc">$</span>sd_f, data.panel.custom<span class="sc">$</span>sd_week, </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>                      data.panel.custom<span class="sc">$</span>alarm_f)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>data.panel.custom.chrono <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">msf_sc_numeric =</span> <span class="fu">as.numeric</span>(msf_sc) <span class="sc">/</span> <span class="dv">3600</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid,msf_sc_numeric, msf_sc)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(msf_sc_numeric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="h2a-the-negative-association-between-late-night-gaming-and-sleep-quality-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2a-the-negative-association-between-late-night-gaming-and-sleep-quality-is-more-pronounced-among-evening-chronotypes.">H2a: The negative association between late-night gaming and sleep quality is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_6 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, psqi_6) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h2a by pid</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For psqi_6 1 means Very good, 2 means Fairly good, 3 means Fairly bad, 4 means Very bad</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a  <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_6_ord =</span> <span class="fu">factor</span>(psqi_6, <span class="at">ordered =</span> <span class="cn">TRUE</span>),  <span class="co"># Convert psqi_6 to an ordered factor</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2a by pid</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to fit the model and catch errors</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>fit_clmm_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    model.h2a <span class="ot">&lt;-</span> <span class="fu">clmm</span>(psqi_6_ord <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric <span class="sc">+</span> </span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>                      age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span> gender),</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data.gaming.latenight.h2a)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the model if it fits successfully</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(model.h2a)</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle the error: print a message and return NULL</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Error: Model failed to converge. Please check the model specification."</span>)</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>model.h2a <span class="ot">&lt;-</span> <span class="fu">fit_clmm_model</span>()</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the model was successfully fitted</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(model.h2a)) {</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modelsummary</span>(</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2a</span><span class="st">`</span> <span class="ot">=</span> model.h2a),</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="cn">NULL</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print a message if the model did not fit</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Model summary was not generated due to convergence issues."</span>)</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="h2b-the-negative-association-between-late-night-gaming-and-sleep-duration-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2b-the-negative-association-between-late-night-gaming-and-sleep-duration-is-more-pronounced-among-evening-chronotypes.">H2b: The negative association between late-night gaming and sleep duration is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert and compute</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_1_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_1</span><span class="st">`</span>), <span class="co"># Convert hours to numeric</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_2_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_2</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">60</span>, <span class="co"># Convert minutes to numeric hours</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_hours_sleep =</span> psqi_4_1_1_1_hours <span class="sc">+</span> psqi_4_1_1_2_hours, <span class="co"># Compute total hours of sleep</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, total_hours_sleep) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b  <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2b by pid</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>model.h2b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(total_hours_sleep <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h2b )</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2b</span><span class="st">`</span> <span class="ot">=</span> model.h2b),</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_92s4lsruqs6qg8rhdgcq(i, j, css_id) {
        var table = document.getElementById("tinytable_92s4lsruqs6qg8rhdgcq");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_92s4lsruqs6qg8rhdgcq');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_92s4lsruqs6qg8rhdgcq(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_92s4lsruqs6qg8rhdgcq");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(0, 0, 'tinytable_css_idn7h88j98akhb7fa1ysbw') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(0, 1, 'tinytable_css_ideguq4h03yauwn4hny9xq') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(1, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(1, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(2, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(2, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(3, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(3, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(4, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(4, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(5, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(5, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(6, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(6, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(7, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(7, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(8, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(8, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(9, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(9, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(10, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(10, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(11, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(11, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(12, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(12, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(13, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(13, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(14, 0, 'tinytable_css_idqvwoj467oh08o9l7nkxf') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(14, 1, 'tinytable_css_idlwgs0xrbfv4a6wxmtfvj') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(15, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(15, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(16, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(16, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(17, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(17, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(18, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(18, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(19, 0, 'tinytable_css_idw8eafj99phx79je80643') })
window.addEventListener('load', function () { styleCell_92s4lsruqs6qg8rhdgcq(19, 1, 'tinytable_css_idtsvebh69pi884k7aq5ep') })
    </script>

    <style>
    .table td.tinytable_css_idn7h88j98akhb7fa1ysbw, .table th.tinytable_css_idn7h88j98akhb7fa1ysbw {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_ideguq4h03yauwn4hny9xq, .table th.tinytable_css_ideguq4h03yauwn4hny9xq {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idw8eafj99phx79je80643, .table th.tinytable_css_idw8eafj99phx79je80643 {  text-align: left; }
    .table td.tinytable_css_idtsvebh69pi884k7aq5ep, .table th.tinytable_css_idtsvebh69pi884k7aq5ep {  text-align: center; }
    .table td.tinytable_css_idqvwoj467oh08o9l7nkxf, .table th.tinytable_css_idqvwoj467oh08o9l7nkxf {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idlwgs0xrbfv4a6wxmtfvj, .table th.tinytable_css_idlwgs0xrbfv4a6wxmtfvj {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_92s4lsruqs6qg8rhdgcq" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H2b</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>6.76 [6.16, 7.37]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.00 [-0.03, 0.03]  </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                                </td>
                  <td>-0.04 [-0.07, 0.00]+</td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>0.10 [-0.17, 0.37]  </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.05 [-0.24, 0.15] </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.04 [-0.24, 0.16] </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>0.05 [-0.22, 0.32]  </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.11 [-0.67, 0.44] </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played × msf_sc_numeric   </td>
                  <td>0.00 [0.00, 0.00]   </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>2.08                </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00                </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>-1.00               </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.17                </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.96                </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>2470                </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.007               </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>13091.5             </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>13172.9             </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.70                </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h2c-the-negative-association-between-late-night-gaming-and-well-being-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2c-the-negative-association-between-late-night-gaming-and-well-being-is-more-pronounced-among-evening-chronotypes.">H2c: The negative association between late-night gaming and well-being is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">latenight =</span> <span class="fu">ifelse</span>(<span class="fu">hour</span>(sessionStart) <span class="sc">&gt;=</span> <span class="dv">23</span> <span class="sc">|</span> <span class="fu">hour</span>(sessionStart) <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>data.gaming.h2c <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define biweekly waves (14-day intervals) that end at day 84</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">14</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">42</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">43</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Assign NA for days beyond 84</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.h2c <span class="sc">%&gt;%</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, latenight, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">biweekly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">14</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(latenight <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1 - None of the time"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2 - Rarely"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3 - Some of the time"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4 - Often"</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5 - All of the time"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>wemwbs_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wemwbs_1"</span>, <span class="st">"wemwbs_2"</span>, <span class="st">"wemwbs_3"</span>, <span class="st">"wemwbs_4"</span>, <span class="st">"wemwbs_5"</span>, <span class="st">"wemwbs_6"</span>, <span class="st">"wemwbs_7"</span>)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(wemwbs_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a wemwbs_total score for panel_balanced</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span>  data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wemwbs_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(wemwbs_columns)))) </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, wemwbs_total) <span class="sc">%&gt;%</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight.h2c, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span> </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c  <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2c by pid</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>model.h2c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wemwbs_total <span class="sc">~</span> biweekly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric   <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> biweekly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled  <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) , <span class="at">data =</span> data.gaming.latenight.h2c )</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model h2c</span><span class="st">`</span> <span class="ot">=</span> model.h2c),</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_xic1g9mcg4iwcmnfnkyc(i, j, css_id) {
        var table = document.getElementById("tinytable_xic1g9mcg4iwcmnfnkyc");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_xic1g9mcg4iwcmnfnkyc');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_xic1g9mcg4iwcmnfnkyc(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_xic1g9mcg4iwcmnfnkyc");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(0, 0, 'tinytable_css_id68no1wc95c09axbso9ed') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(0, 1, 'tinytable_css_idio4nlktfwm1xp15hc9a7') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(1, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(1, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(2, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(2, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(3, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(3, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(4, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(4, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(5, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(5, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(6, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(6, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(7, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(7, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(8, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(8, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(9, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(9, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(10, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(10, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(11, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(11, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(12, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(12, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(13, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(13, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(14, 0, 'tinytable_css_idwtb2u6bqcxb3vetiaj79') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(14, 1, 'tinytable_css_id0si5cqxczwcm655xkaz7') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(15, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(15, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(16, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(16, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(17, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(17, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(18, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(18, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(19, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(19, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(20, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(20, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(21, 0, 'tinytable_css_idm8ieumsj01iu058i58zy') })
window.addEventListener('load', function () { styleCell_xic1g9mcg4iwcmnfnkyc(21, 1, 'tinytable_css_ido8i9vd55gl885ghqu927') })
    </script>

    <style>
    .table td.tinytable_css_id68no1wc95c09axbso9ed, .table th.tinytable_css_id68no1wc95c09axbso9ed {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idio4nlktfwm1xp15hc9a7, .table th.tinytable_css_idio4nlktfwm1xp15hc9a7 {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idm8ieumsj01iu058i58zy, .table th.tinytable_css_idm8ieumsj01iu058i58zy {  text-align: left; }
    .table td.tinytable_css_ido8i9vd55gl885ghqu927, .table th.tinytable_css_ido8i9vd55gl885ghqu927 {  text-align: center; }
    .table td.tinytable_css_idwtb2u6bqcxb3vetiaj79, .table th.tinytable_css_idwtb2u6bqcxb3vetiaj79 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id0si5cqxczwcm655xkaz7, .table th.tinytable_css_id0si5cqxczwcm655xkaz7 {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_xic1g9mcg4iwcmnfnkyc" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model h2c</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                    </td>
                  <td>21.14 [18.10, 24.18]***</td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played                    </td>
                  <td>0.00 [-0.02, 0.02]     </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                                 </td>
                  <td>0.00 [-0.03, 0.02]     </td>
                </tr>
                <tr>
                  <td>age_scaled                                     </td>
                  <td>0.01 [-0.19, 0.21]     </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                     </td>
                  <td>0.07 [-0.07, 0.22]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                               </td>
                  <td>-0.04 [-0.19, 0.10]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                      </td>
                  <td>-0.01 [-0.23, 0.21]    </td>
                </tr>
                <tr>
                  <td>regionUS                                       </td>
                  <td>-0.24 [-0.64, 0.16]    </td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played × msf_sc_numeric   </td>
                  <td>0.00 [0.00, 0.00]      </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                             </td>
                  <td>1.30                   </td>
                </tr>
                <tr>
                  <td>SD (biweekly_avg_minutes_played pid)           </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~biweekly_avg_minutes_played pid)</td>
                  <td>0.99                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                          </td>
                  <td>3.43                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                              </td>
                  <td>3.47                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                       </td>
                  <td>4492                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                       </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>R2 Cond.                                       </td>
                  <td>0.531                  </td>
                </tr>
                <tr>
                  <td>AIC                                            </td>
                  <td>24456.2                </td>
                </tr>
                <tr>
                  <td>BIC                                            </td>
                  <td>24546.0                </td>
                </tr>
                <tr>
                  <td>ICC                                            </td>
                  <td>0.5                    </td>
                </tr>
                <tr>
                  <td>RMSE                                           </td>
                  <td>3.34                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h2d-the-negative-association-between-late-night-gaming-and-daytime-sleepiness-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2d-the-negative-association-between-late-night-gaming-and-daytime-sleepiness-is-more-pronounced-among-evening-chronotypes.">H2d: The negative association between late-night gaming and daytime sleepiness is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">latenight =</span> <span class="fu">ifelse</span>(<span class="fu">hour</span>(sessionStart) <span class="sc">&gt;=</span> <span class="dv">23</span> <span class="sc">|</span> <span class="fu">hour</span>(sessionStart) <span class="sc">&lt;</span> <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, latenight, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(latenight <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No chance of dozing"</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Slight chance of dozing"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moderate chance of dozing"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High chance of dozing"</span> <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>eps_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^eps"</span>, <span class="fu">names</span>(data.panel), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(eps_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a eps_total score for panel_balanced</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eps_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(data.panel.custom, eps_columns)))</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, eps_total) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> </span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d  <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2d by pid</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>model.h2d <span class="ot">&lt;-</span> <span class="fu">lmer</span>(eps_total <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h2d )</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2d</span><span class="st">`</span> <span class="ot">=</span> model.h2d),</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_kpa4azj6il6ksbjc6e96(i, j, css_id) {
        var table = document.getElementById("tinytable_kpa4azj6il6ksbjc6e96");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_kpa4azj6il6ksbjc6e96');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_kpa4azj6il6ksbjc6e96(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_kpa4azj6il6ksbjc6e96");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(0, 0, 'tinytable_css_id3uu00z0cu4rpw173bnbn') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(0, 1, 'tinytable_css_idr7p5nu4jj4p6hnmfbs9m') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(1, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(1, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(2, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(2, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(3, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(3, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(4, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(4, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(5, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(5, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(6, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(6, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(7, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(7, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(8, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(8, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(9, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(9, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(10, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(10, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(11, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(11, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(12, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(12, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(13, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(13, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(14, 0, 'tinytable_css_idt7z6ysq5u77micb1ukx1') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(14, 1, 'tinytable_css_id0wikrahupshbjswfk8kf') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(15, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(15, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(16, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(16, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(17, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(17, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(18, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(18, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(19, 0, 'tinytable_css_idxsh71bchpyybkbcokyqz') })
window.addEventListener('load', function () { styleCell_kpa4azj6il6ksbjc6e96(19, 1, 'tinytable_css_id7jdddrixiqmzvvw33rq5') })
    </script>

    <style>
    .table td.tinytable_css_id3uu00z0cu4rpw173bnbn, .table th.tinytable_css_id3uu00z0cu4rpw173bnbn {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idr7p5nu4jj4p6hnmfbs9m, .table th.tinytable_css_idr7p5nu4jj4p6hnmfbs9m {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idxsh71bchpyybkbcokyqz, .table th.tinytable_css_idxsh71bchpyybkbcokyqz {  text-align: left; }
    .table td.tinytable_css_id7jdddrixiqmzvvw33rq5, .table th.tinytable_css_id7jdddrixiqmzvvw33rq5 {  text-align: center; }
    .table td.tinytable_css_idt7z6ysq5u77micb1ukx1, .table th.tinytable_css_idt7z6ysq5u77micb1ukx1 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id0wikrahupshbjswfk8kf, .table th.tinytable_css_id0wikrahupshbjswfk8kf {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_kpa4azj6il6ksbjc6e96" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H2d</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>12.09 [11.57, 12.61]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.01 [-0.02, 0.04]     </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                                </td>
                  <td>0.00 [-0.03, 0.03]     </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.05 [-0.29, 0.19]    </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>0.02 [-0.15, 0.19]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>0.01 [-0.16, 0.19]     </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.01 [-0.26, 0.24]    </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.09 [-0.57, 0.40]    </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played × msf_sc_numeric   </td>
                  <td>0.00 [0.00, 0.00]      </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.63                   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.01                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>1.00                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.78                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>2470                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.003                  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>12688.0                </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>12769.3                </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.55                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>