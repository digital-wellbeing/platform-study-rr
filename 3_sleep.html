<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Study 2: Gaming and Sleep</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="3_sleep_files/libs/clipboard/clipboard.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/quarto.js"></script>
<script src="3_sleep_files/libs/quarto-html/popper.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="3_sleep_files/libs/quarto-html/anchor.min.js"></script>
<link href="3_sleep_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="3_sleep_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="3_sleep_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="3_sleep_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="3_sleep_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">

<main class="content column-page" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Study 2: Gaming and Sleep</h1>
</div>



<div class="quarto-title-meta column-page">

    
  
    
  </div>
  


</header>


<section id="study-2-gaming-and-sleep" class="level1">
<h1>Study 2: Gaming and Sleep</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse, lme4, marginaleffects, glmmTMB, mice, ordinal, modelsummary, lubridate, mctq)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>studyStartDate <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(<span class="st">"2024-05-01 00:00:00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data.diary &lt;- read_csv("data-synthetic/synDiaryClean.csv") # requires that the preprocessing script has been run</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.diary &lt;- readRDS("data-synthetic/synDiaryClean.rds") # requires that the preprocessing script has been run</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data.intake <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synIntake.rds"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data.nin <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synNintendo.rds"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data.xbox <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synXbox.rds"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>data.steam <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synSteam.rds"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.android &lt;- readRDS("data-synthetic/synAndroid.rds")</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># data.ios &lt;- readRDS("data-synthetic/syniOS.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.nin.custom <span class="ot">&lt;-</span> data.nin <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionEnd =</span> sessionStart <span class="sc">+</span> <span class="fu">minutes</span>(<span class="fu">as.integer</span>(duration)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data.steam.custom <span class="ot">&lt;-</span> data.steam <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionStart =</span> <span class="fu">as.POSIXct</span>(<span class="fu">paste</span>(date, hour), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H"</span>), </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sessionEnd =</span> sessionStart<span class="sc">+</span><span class="fu">minutes</span>(<span class="fu">as.integer</span>(minutes)))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>data.xbox.custom <span class="ot">&lt;-</span> data.xbox <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sessionEnd =</span> sessionStart <span class="sc">+</span> <span class="fu">minutes</span>(<span class="fu">as.integer</span>(duration)))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># going to ignore iOS for this study due to lack of temporal resolution</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># data.android.custom &lt;- data.android %&gt;% filter(category == "Games") %&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(time = sessionStart, sessionStart = ymd_hms(paste(date, sessionStart)), sessionEnd = sessionStart+minutes(as.integer(duration))) %&gt;% mutate(platform="Android")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>calculate_latenight_minutes <span class="ot">&lt;-</span> <span class="cf">function</span>(start_time, end_time, <span class="at">latenight_onset =</span> <span class="st">"23:00"</span>, <span class="at">latenight_offset =</span> <span class="st">"06:00"</span>) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end_time, start_time, <span class="at">units =</span> <span class="st">"days"</span>)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># Return NA if the times are more than 1 day apart</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check if end_time and start_time are on the same day or not and store in a logical</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  same_day <span class="ot">&lt;-</span> <span class="fu">as_date</span>(start_time) <span class="sc">==</span> <span class="fu">as_date</span>(end_time)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>same_day){</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parse evening_time and morning_time</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  latenight_onset <span class="ot">&lt;-</span> <span class="fu">hms</span>(<span class="fu">paste0</span>(latenight_onset, <span class="st">":00"</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  latenight_offset <span class="ot">&lt;-</span> <span class="fu">hms</span>(<span class="fu">paste0</span>(latenight_offset, <span class="st">":00"</span>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to create a datetime for the latenight boundary</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  create_boundary <span class="ot">&lt;-</span> <span class="cf">function</span>(base_time, boundary_time) {</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">update</span>(base_time, <span class="at">hour =</span> <span class="fu">hour</span>(boundary_time), <span class="at">minute =</span> <span class="fu">minute</span>(boundary_time), <span class="at">second =</span> <span class="fu">second</span>(boundary_time))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (boundary_time <span class="sc">&lt;</span> latenight_onset <span class="sc">&amp;&amp;</span> <span class="fu">hms</span>(<span class="fu">format</span>(base_time, <span class="st">"%H:%M:%S"</span>)) <span class="sc">&gt;=</span> latenight_onset) {</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> result <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    result</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create latenight start and end times</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  latenight_start <span class="ot">&lt;-</span> <span class="fu">create_boundary</span>(start_time, latenight_onset)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  latenight_end <span class="ot">&lt;-</span> <span class="fu">create_boundary</span>(start_time, latenight_offset)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust if latenight_end is before latenight_start (crosses midnight)</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (latenight_end <span class="sc">&lt;=</span> latenight_start) {</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    latenight_end <span class="ot">&lt;-</span> latenight_end <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate total latenight minutes</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  total_minutes <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  current_start <span class="ot">&lt;-</span> start_time</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (current_start <span class="sc">&lt;</span> end_time) {</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    current_latenight_start <span class="ot">&lt;-</span> <span class="fu">max</span>(current_start, latenight_start)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    current_latenight_end <span class="ot">&lt;-</span> <span class="fu">min</span>(end_time, latenight_end)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (current_latenight_start <span class="sc">&lt;</span> current_latenight_end) {</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      total_minutes <span class="ot">&lt;-</span> total_minutes <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(current_latenight_end, current_latenight_start, <span class="at">units =</span> <span class="st">"mins"</span>))</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    current_start <span class="ot">&lt;-</span> latenight_end</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    latenight_start <span class="ot">&lt;-</span> latenight_start <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    latenight_end <span class="ot">&lt;-</span> latenight_end <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the evening_time (midnight) and morning_time as POSIXct objects</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Example: Define evening_time and morning_time as hh:mm strings</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the hh:mm strings to full datetime objects, using today's date</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    evening_time_updated <span class="ot">&lt;-</span> <span class="fu">update</span>(start_time, <span class="at">hours =</span> <span class="dv">0</span>, <span class="at">minutes =</span> <span class="dv">0</span>, <span class="at">seconds =</span> <span class="dv">0</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split morning_time into hours and minutes</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    hh_mm <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(latenight_offset, <span class="st">":"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    hh <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(hh_mm[<span class="dv">1</span>])</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    mm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(hh_mm[<span class="dv">2</span>])</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update start_time to have the time set to morning_time</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    morning_time_updated <span class="ot">&lt;-</span> <span class="fu">update</span>(start_time, <span class="at">hours =</span> hh, <span class="at">minutes =</span> mm, <span class="at">seconds =</span> <span class="dv">0</span>)</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the interval for the late-night period (00:00 to 06:00)</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    latenight_interval <span class="ot">&lt;-</span> <span class="fu">interval</span>(evening_time_updated, morning_time_updated)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the interval for the given session</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    session_interval <span class="ot">&lt;-</span> <span class="fu">interval</span>(start_time, end_time)</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the intersection of the two intervals</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    intersection <span class="ot">&lt;-</span> <span class="fu">intersect</span>(latenight_interval, session_interval)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the duration of the intersection in minutes</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(intersection)) {</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>      total_minutes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.duration</span>(intersection), <span class="st">"minutes"</span>)</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>      total_minutes <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total_minutes)</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 1: Session entirely within the latenight period</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>start_time1 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-28 23:30:00"</span>)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>end_time1 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 01:30:00"</span>)</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time1, end_time1))  <span class="co"># Expected: 120 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 120</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 2: Session partially overlapping with the latenight period (starts before latenight)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>start_time2 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-28 22:30:00"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>end_time2 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 00:30:00"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time2, end_time2))  <span class="co"># Expected: 90</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 3: Session partially overlapping with the latenight period (ends after latenight)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>start_time3 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 05:30:00"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>end_time3 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 07:00:00"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time3, end_time3))  <span class="co"># Expected: 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 4: Session not overlapping with the latenight period</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>start_time4 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-28 10:00:00"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>end_time4 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-28 12:00:00"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time4, end_time4))  <span class="co"># Expected: 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 5: Session spanning two days</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>start_time5 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-28 22:00:00"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>end_time5 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 07:00:00"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time5, end_time5))  <span class="co"># Expected: 420</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 420</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 6: Session partially overlapping with the latenight period (ends after latenight)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>start_time6 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 01:00:00"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>end_time6 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 07:00:00"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time6, end_time6))  <span class="co"># Expected: 300</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 300</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 7: Session spanning multiple days</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>start_time7 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-23 01:00:00"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>end_time7 <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">"2024-08-29 07:00:00"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">calculate_latenight_minutes</span>(start_time7, end_time7))  <span class="co"># Expected: NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="cell" data-tags="slow">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future.apply)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(progressr)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data.xbox.custom, data.steam.custom, data.nin.custom)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">minutes_played =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(sessionEnd, sessionStart, <span class="at">units =</span> <span class="st">"mins"</span>)))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data frame to data.table</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(data.gaming)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up parallel processing using multiple cores</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers=</span>parallel<span class="sc">::</span><span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># You can specify the number of workers as plan(multisession, workers = n)</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Time the parallel operation with a progress bar</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_progress</span>({</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(data.gaming))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    data.gaming[, latenight_gaming_minutes <span class="sc">:</span><span class="er">=</span> <span class="fu">future_mapply</span>(</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(start_time, end_time) {</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()  <span class="co"># Update progress bar</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calculate_latenight_minutes</span>(start_time, end_time)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>      sessionStart, sessionEnd, <span class="at">SIMPLIFY =</span> <span class="cn">TRUE</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    )]</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out rows with NA values</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  data.gaming <span class="ot">&lt;-</span> data.gaming[<span class="sc">!</span><span class="fu">is.na</span>(latenight_gaming_minutes)]</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   user  system elapsed 
  13.06    3.39  458.21 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset to sequential processing</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data.gaming back to data.frame</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.gaming)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage: Apply the function to calculate latenight minutes with flexible evening and morning hours</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   rowwise() %&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(latenight_gaming_minutes = calculate_latenight_minutes(sessionStart, sessionEnd)) %&gt;%  filter(!is.na(latenight_gaming_minutes)) %&gt;% ungroup()</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create an isWeekend variable for data.gaming if the sessionStart is on a Friday or Saturday</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isWeekend =</span> <span class="fu">ifelse</span>(<span class="fu">weekdays</span>(sessionStart) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Friday"</span>, <span class="st">"Saturday"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>data.gaming <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(latenight_gaming_minutes)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(monthly_avg_minutes_played  <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: make sure psqi_4#1_1_* have reasonable values in panel_balanced</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the minimum and maximum values of the column</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># min_val &lt;- min(panel_balanced$`psqi_4#1_1_1`, na.rm = TRUE)</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co"># max_val &lt;- max(panel_balanced$`psqi_4#1_1_1`, na.rm = TRUE)</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rescale the values to be between 0 and 12</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># panel_balanced$`psqi_4#1_1_1` &lt;- (panel_balanced$`psqi_4#1_1_1` - min_val) / (max_val - min_val) * 12</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate the minimum and maximum values of the column</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co"># min_val &lt;- min(panel_balanced$`psqi_4#1_1_2`, na.rm = TRUE)</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># max_val &lt;- max(panel_balanced$`psqi_4#1_1_2`, na.rm = TRUE)</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rescale the values to be between 0 and 12</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co"># panel_balanced$`psqi_4#1_1_2` &lt;- (panel_balanced$`psqi_4#1_1_2` - min_val) / (max_val - min_val) * 60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="h1" class="level1">
<h1>H1</h1>
<section id="h1a-late-night-gaming-is-associated-with-poorer-sleep-quality." class="level2">
<h2 class="anchored" data-anchor-id="h1a-late-night-gaming-is-associated-with-poorer-sleep-quality.">H1a: Late-night gaming is associated with poorer sleep quality.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_6 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, psqi_6) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For psqi_6 1 means Very good, 2 means Fairly good, 3 means Fairly bad, 4 means Very bad</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a  <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_6_ord =</span> <span class="fu">factor</span>(psqi_6, <span class="at">ordered =</span> <span class="cn">TRUE</span>),  <span class="co"># Convert psqi_6 to an ordered factor</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1a <span class="ot">&lt;-</span> data.gaming.latenight.h1a <span class="sc">%&gt;%</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with rescaled covariates</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>model.h1a <span class="ot">&lt;-</span> <span class="fu">clmm</span>(psqi_6_ord <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>gender),</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data.gaming.latenight.h1a)</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1a</span><span class="st">`</span> <span class="ot">=</span> model.h1a),</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_7ubx3luo8xpptgaq3qaz(i, j, css_id) {
        var table = document.getElementById("tinytable_7ubx3luo8xpptgaq3qaz");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7ubx3luo8xpptgaq3qaz');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_7ubx3luo8xpptgaq3qaz(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7ubx3luo8xpptgaq3qaz");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(0, 0, 'tinytable_css_idxix3xzeq1bbxq4hvwrij') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(0, 1, 'tinytable_css_id7z7km4744gb47ka102xj') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(1, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(1, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(2, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(2, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(3, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(3, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(4, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(4, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(5, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(5, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(6, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(6, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(7, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(7, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(8, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(8, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(9, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(9, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(10, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(10, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(11, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(11, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(12, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(12, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(13, 0, 'tinytable_css_idmg0g1fzbqb3pi5sllv9q') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(13, 1, 'tinytable_css_idse7nyk9w6ag47cvxgzhq') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(14, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(14, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(15, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(15, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(16, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(16, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(17, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(17, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(18, 0, 'tinytable_css_idybgh87731ulolf0ir7wk') })
window.addEventListener('load', function () { styleCell_7ubx3luo8xpptgaq3qaz(18, 1, 'tinytable_css_id0luraxw34orc4atrq1v7') })
    </script>

    <style>
    .table td.tinytable_css_idxix3xzeq1bbxq4hvwrij, .table th.tinytable_css_idxix3xzeq1bbxq4hvwrij {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id7z7km4744gb47ka102xj, .table th.tinytable_css_id7z7km4744gb47ka102xj {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idybgh87731ulolf0ir7wk, .table th.tinytable_css_idybgh87731ulolf0ir7wk {  text-align: left; }
    .table td.tinytable_css_id0luraxw34orc4atrq1v7, .table th.tinytable_css_id0luraxw34orc4atrq1v7 {  text-align: center; }
    .table td.tinytable_css_idmg0g1fzbqb3pi5sllv9q, .table th.tinytable_css_idmg0g1fzbqb3pi5sllv9q {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idse7nyk9w6ag47cvxgzhq, .table th.tinytable_css_idse7nyk9w6ag47cvxgzhq {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_7ubx3luo8xpptgaq3qaz" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1a</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1|2                                           </td>
                  <td>-1.47  </td>
                </tr>
                <tr>
                  <td>2|3                                           </td>
                  <td>-0.07  </td>
                </tr>
                <tr>
                  <td>3|4                                           </td>
                  <td>1.30   </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.00   </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.12  </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>0.06   </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.04  </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.05  </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.10  </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.15   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>1.00   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.95   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5545   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.005  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>14938.7</td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>15024.8</td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.42   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1b-late-night-gaming-is-associated-with-shorter-sleep-duration." class="level2">
<h2 class="anchored" data-anchor-id="h1b-late-night-gaming-is-associated-with-shorter-sleep-duration.">H1b: Late-night gaming is associated with shorter sleep duration.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert and compute</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_1_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_1</span><span class="st">`</span>), <span class="co"># Convert hours to numeric</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_2_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_2</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">60</span>, <span class="co"># Convert minutes to numeric hours</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_hours_sleep =</span> psqi_4_1_1_1_hours <span class="sc">+</span> psqi_4_1_1_2_hours, <span class="co"># Compute total hours of sleep</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, total_hours_sleep) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b  <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1b <span class="ot">&lt;-</span> data.gaming.latenight.h1b <span class="sc">%&gt;%</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>model.h1b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(total_hours_sleep <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) <span class="sc">+</span> isWeekend, <span class="at">data =</span> data.gaming.latenight.h1b )</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1b</span><span class="st">`</span> <span class="ot">=</span> model.h1b),</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_oerujpedaj7l594r8lc4(i, j, css_id) {
        var table = document.getElementById("tinytable_oerujpedaj7l594r8lc4");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_oerujpedaj7l594r8lc4');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_oerujpedaj7l594r8lc4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_oerujpedaj7l594r8lc4");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(0, 0, 'tinytable_css_idh5a825o4nkexkcfzsxx3') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(0, 1, 'tinytable_css_idg3k3au9ass2n4nh5dorq') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(1, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(1, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(2, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(2, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(3, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(3, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(4, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(4, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(5, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(5, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(6, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(6, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(7, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(7, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(8, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(8, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(9, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(9, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(10, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(10, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(11, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(11, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(12, 0, 'tinytable_css_idsst737mqs3xmhgart3xa') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(12, 1, 'tinytable_css_idarde3etb4po81pncelre') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(13, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(13, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(14, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(14, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(15, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(15, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(16, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(16, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(17, 0, 'tinytable_css_idumfp5ka2r2lmwufitl5r') })
window.addEventListener('load', function () { styleCell_oerujpedaj7l594r8lc4(17, 1, 'tinytable_css_id5kq7otwdjp6o4dgsholw') })
    </script>

    <style>
    .table td.tinytable_css_idh5a825o4nkexkcfzsxx3, .table th.tinytable_css_idh5a825o4nkexkcfzsxx3 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idg3k3au9ass2n4nh5dorq, .table th.tinytable_css_idg3k3au9ass2n4nh5dorq {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idumfp5ka2r2lmwufitl5r, .table th.tinytable_css_idumfp5ka2r2lmwufitl5r {  text-align: left; }
    .table td.tinytable_css_id5kq7otwdjp6o4dgsholw, .table th.tinytable_css_id5kq7otwdjp6o4dgsholw {  text-align: center; }
    .table td.tinytable_css_idsst737mqs3xmhgart3xa, .table th.tinytable_css_idsst737mqs3xmhgart3xa {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idarde3etb4po81pncelre, .table th.tinytable_css_idarde3etb4po81pncelre {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_oerujpedaj7l594r8lc4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1b</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>6.52 [6.20, 6.85]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.00 [-0.01, 0.01]  </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.06 [-0.24, 0.12] </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.03 [-0.16, 0.10] </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.06 [-0.19, 0.07] </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.31 [-0.66, 0.05]+</td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>0.02 [-0.16, 0.19]  </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>2.00                </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00                </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>-1.00               </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.22                </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.93                </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5545                </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.002               </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>29127.2             </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>29206.7             </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.68                </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1c-late-night-gaming-is-associated-with-lower-well-being." class="level2">
<h2 class="anchored" data-anchor-id="h1c-late-night-gaming-is-associated-with-lower-well-being.">H1c: Late-night gaming is associated with lower well-being.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- bind_rows(data.xbox.custom, data.steam.custom, data.nin.custom)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minutes_played = as.numeric(difftime(sessionEnd, sessionStart, units = "mins")))</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(latenight = ifelse(hour(sessionStart) &gt;= 23 | hour(sessionStart) &lt; 6, 1, 0))</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(isWeekend = ifelse(weekdays(sessionStart) %in% c("Friday", "Saturday"), 1, 0))</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>data.gaming.h1c <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define biweekly waves (14-day intervals) that end at day 84</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">14</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">42</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">43</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Assign NA for days beyond 84</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.h1c <span class="sc">%&gt;%</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, isWeekend) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">biweekly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">14</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(biweekly_avg_minutes_played  <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1 - None of the time"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2 - Rarely"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3 - Some of the time"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4 - Often"</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5 - All of the time"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>wemwbs_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wemwbs_1"</span>, <span class="st">"wemwbs_2"</span>, <span class="st">"wemwbs_3"</span>, <span class="st">"wemwbs_4"</span>, <span class="st">"wemwbs_5"</span>, <span class="st">"wemwbs_6"</span>, <span class="st">"wemwbs_7"</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(wemwbs_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a wemwbs_total score for panel_balanced</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span>  data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wemwbs_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(wemwbs_columns)))) </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, wemwbs_total) <span class="sc">%&gt;%</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight.h1c, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span> </span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c  <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1c <span class="ot">&lt;-</span> data.gaming.latenight.h1c <span class="sc">%&gt;%</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>model.h1c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wemwbs_total <span class="sc">~</span> biweekly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> biweekly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) <span class="sc">+</span> isWeekend, <span class="at">data =</span> data.gaming.latenight.h1c )</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1c</span><span class="st">`</span> <span class="ot">=</span> model.h1c),</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_v3ozntnxbjz2gtx5gt4t(i, j, css_id) {
        var table = document.getElementById("tinytable_v3ozntnxbjz2gtx5gt4t");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_v3ozntnxbjz2gtx5gt4t');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_v3ozntnxbjz2gtx5gt4t(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_v3ozntnxbjz2gtx5gt4t");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(0, 0, 'tinytable_css_idnr5d2lwrh6l694eheul0') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(0, 1, 'tinytable_css_id3fw7dh6nr5raa56ipf3o') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(1, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(1, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(2, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(2, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(3, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(3, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(4, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(4, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(5, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(5, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(6, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(6, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(7, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(7, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(8, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(8, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(9, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(9, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(10, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(10, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(11, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(11, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(12, 0, 'tinytable_css_id9488131oybaits3cmkrf') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(12, 1, 'tinytable_css_id1ia3vwyscjmyp3671knn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(13, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(13, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(14, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(14, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(15, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(15, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(16, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(16, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(17, 0, 'tinytable_css_idhu93ngauwt6w80hyjfrh') })
window.addEventListener('load', function () { styleCell_v3ozntnxbjz2gtx5gt4t(17, 1, 'tinytable_css_id9lhagiztv1rnq4y1koyn') })
    </script>

    <style>
    .table td.tinytable_css_idnr5d2lwrh6l694eheul0, .table th.tinytable_css_idnr5d2lwrh6l694eheul0 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id3fw7dh6nr5raa56ipf3o, .table th.tinytable_css_id3fw7dh6nr5raa56ipf3o {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idhu93ngauwt6w80hyjfrh, .table th.tinytable_css_idhu93ngauwt6w80hyjfrh {  text-align: left; }
    .table td.tinytable_css_id9lhagiztv1rnq4y1koyn, .table th.tinytable_css_id9lhagiztv1rnq4y1koyn {  text-align: center; }
    .table td.tinytable_css_id9488131oybaits3cmkrf, .table th.tinytable_css_id9488131oybaits3cmkrf {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id1ia3vwyscjmyp3671knn, .table th.tinytable_css_id1ia3vwyscjmyp3671knn {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_v3ozntnxbjz2gtx5gt4t" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1c</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                    </td>
                  <td>21.10 [18.10, 24.11]***</td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played                    </td>
                  <td>0.00 [0.00, 0.00]      </td>
                </tr>
                <tr>
                  <td>age_scaled                                     </td>
                  <td>0.05 [-0.07, 0.18]     </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                     </td>
                  <td>0.03 [-0.06, 0.12]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                               </td>
                  <td>0.02 [-0.07, 0.11]     </td>
                </tr>
                <tr>
                  <td>regionUS                                       </td>
                  <td>-0.08 [-0.33, 0.17]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                      </td>
                  <td>-0.02 [-0.15, 0.12]    </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                             </td>
                  <td>1.39                   </td>
                </tr>
                <tr>
                  <td>SD (biweekly_avg_minutes_played pid)           </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~biweekly_avg_minutes_played pid)</td>
                  <td>-1.00                  </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                          </td>
                  <td>3.42                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                              </td>
                  <td>3.46                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                       </td>
                  <td>12572                  </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                       </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>AIC                                            </td>
                  <td>68246.6                </td>
                </tr>
                <tr>
                  <td>BIC                                            </td>
                  <td>68335.8                </td>
                </tr>
                <tr>
                  <td>RMSE                                           </td>
                  <td>3.34                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h1d-late-night-gaming-is-associated-with-higher-daytime-sleepiness." class="level2">
<h2 class="anchored" data-anchor-id="h1d-late-night-gaming-is-associated-with-higher-daytime-sleepiness.">H1d: Late-night gaming is associated with higher daytime sleepiness.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- bind_rows(data.xbox.custom, data.steam.custom, data.nin.custom)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minutes_played = as.numeric(difftime(sessionEnd, sessionStart, units = "mins")))</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(latenight = ifelse(hour(sessionStart) &gt;= 23 | hour(sessionStart) &lt; 6, 1, 0))</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(isWeekend = ifelse(weekdays(sessionStart) %in% c("Friday", "Saturday"), 1, 0))</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # Example data frame</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>data.gaming.h1d <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming.h1d <span class="sc">%&gt;%</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(latenight_gaming_minutes)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(monthly_avg_minutes_played  <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No chance of dozing"</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Slight chance of dozing"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moderate chance of dozing"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High chance of dozing"</span> <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>eps_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^eps"</span>, <span class="fu">names</span>(data.panel), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(eps_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a eps_total score for panel_balanced</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eps_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(data.panel.custom, eps_columns)))</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, eps_total) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span> </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d  <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h1d <span class="ot">&lt;-</span> data.gaming.latenight.h1d <span class="sc">%&gt;%</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>model.h1d <span class="ot">&lt;-</span> <span class="fu">lmer</span>(eps_total <span class="sc">~</span> monthly_avg_minutes_played <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h1d )</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H1d</span><span class="st">`</span> <span class="ot">=</span> model.h1d),</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_9pvfp1deksxmaylk8jae(i, j, css_id) {
        var table = document.getElementById("tinytable_9pvfp1deksxmaylk8jae");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_9pvfp1deksxmaylk8jae');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_9pvfp1deksxmaylk8jae(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_9pvfp1deksxmaylk8jae");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(0, 0, 'tinytable_css_id0hlsbgi4m7jxejbeev8s') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(0, 1, 'tinytable_css_idvwg27jgbd41om4uinfpl') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(1, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(1, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(2, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(2, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(3, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(3, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(4, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(4, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(5, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(5, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(6, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(6, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(7, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(7, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(8, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(8, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(9, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(9, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(10, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(10, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(11, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(11, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(12, 0, 'tinytable_css_idxwwlud8x995k6ugoh9z1') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(12, 1, 'tinytable_css_idx28uzgpvm1rmcrck382v') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(13, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(13, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(14, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(14, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(15, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(15, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(16, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(16, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(17, 0, 'tinytable_css_id82spmdn6hxprz4ar1rcc') })
window.addEventListener('load', function () { styleCell_9pvfp1deksxmaylk8jae(17, 1, 'tinytable_css_idyye32iq93rg5z7h8ff6x') })
    </script>

    <style>
    .table td.tinytable_css_id0hlsbgi4m7jxejbeev8s, .table th.tinytable_css_id0hlsbgi4m7jxejbeev8s {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idvwg27jgbd41om4uinfpl, .table th.tinytable_css_idvwg27jgbd41om4uinfpl {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id82spmdn6hxprz4ar1rcc, .table th.tinytable_css_id82spmdn6hxprz4ar1rcc {  text-align: left; }
    .table td.tinytable_css_idyye32iq93rg5z7h8ff6x, .table th.tinytable_css_idyye32iq93rg5z7h8ff6x {  text-align: center; }
    .table td.tinytable_css_idxwwlud8x995k6ugoh9z1, .table th.tinytable_css_idxwwlud8x995k6ugoh9z1 {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idx28uzgpvm1rmcrck382v, .table th.tinytable_css_idx28uzgpvm1rmcrck382v {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_9pvfp1deksxmaylk8jae" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H1d</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>12.03 [11.78, 12.27]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>-0.01 [-0.02, 0.00]    </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.02 [-0.18, 0.15]    </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.06 [-0.17, 0.06]    </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.03 [-0.15, 0.09]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.05 [-0.21, 0.12]    </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>0.00 [-0.33, 0.32]     </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.70                   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>1.00                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.03                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.78                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>5545                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>28407.1                </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>28486.6                </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.56                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
</section>
<section id="h2" class="level1">
<h1>H2</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_1 to work  and turn it into a logical variable where 1 is 1 and 2 is 0, other is NA</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">work =</span> <span class="fu">ifelse</span>(mctq_1 <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_1 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_2 to "wd" </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">wd =</span> mctq_2_1, <span class="at">bt_w =</span> mctq_3_1, <span class="at">sprep_w =</span> mctq_3_3, <span class="at">slat_w =</span> mctq_3_4, <span class="at">se_w =</span> mctq_3_5, <span class="at">si_w =</span> mctq_3_6)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Yes/No in mctq_4_1 to logical</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alarm_w =</span> <span class="fu">ifelse</span>(mctq_4_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_4_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert  Yes/No in mctq_5_1 to logical and name it wake_before_w</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">wake_before_w =</span> <span class="fu">ifelse</span>(mctq_5_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_5_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">bt_f =</span> mctq_6_1, <span class="at">sprep_f =</span> mctq_6_3, <span class="at">slat_f =</span> mctq_6_4, <span class="at">se_f =</span> mctq_6_5, <span class="at">si_f =</span> mctq_6_6)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Yes/No in mctq_7_1 to logical</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alarm_f =</span> <span class="fu">ifelse</span>(mctq_7_1 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_7_1 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">reasons_f =</span> <span class="fu">ifelse</span>(mctq_7_2 <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mctq_7_2 <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># rename mctq_8_1 to "reasons_why_f"</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">reasons_why_f =</span> mctq_8_1)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="st">"wd"</span>, as.integer),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^work$|^alarm_|^wake_|^reasons_f$"</span>),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                as.logical),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^bt_|^sprep_|^se_"</span>), hms<span class="sc">::</span>parse_hm),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">matches</span>(<span class="st">"^slat_|^si_"</span>),</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> lubridate<span class="sc">::</span><span class="fu">dminutes</span>(<span class="fu">as.numeric</span>(.x)))</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for participants who have completed the MCTQ</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(work))</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Sleep onset</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>so_w <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">so</span>(data.panel.custom<span class="sc">$</span>sprep_w, data.panel.custom<span class="sc">$</span>slat_w)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>so_f <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">so</span>(data.panel.custom<span class="sc">$</span>sprep_f, data.panel.custom<span class="sc">$</span>slat_f)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Sleep duration</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_w <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sdu</span>(data.panel.custom<span class="sc">$</span>so_w, data.panel.custom<span class="sc">$</span>se_w)</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_f <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sdu</span>(data.panel.custom<span class="sc">$</span>so_f, data.panel.custom<span class="sc">$</span>se_f)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Midsleep time</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msw <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msl</span>(data.panel.custom<span class="sc">$</span>so_w, data.panel.custom<span class="sc">$</span>sd_w)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msf <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msl</span>(data.panel.custom<span class="sc">$</span>so_f, data.panel.custom<span class="sc">$</span>sd_f)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calc Weekly sleep duration</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>sd_week <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">sd_week</span>(data.panel.custom<span class="sc">$</span>sd_w, data.panel.custom<span class="sc">$</span>sd_f, data.panel.custom<span class="sc">$</span>wd)</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Chronotype</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Chronotype or sleep-corrected local time of mid-sleep on work-free days</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="co"># msf_sc() allows you to compute the chronotype, or corrected local time of mid-sleep on work-free days. It takes five arguments: msf (local time of mid-sleep on work-free days), sd_w (sleep duration on workdays), sd_f (sleep duration on work-free days), sd_week(average weekly sleep duration), and alarm_f (a logical object indicating if the respondent uses an alarm clock to wake up on work-free days).</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="co"># If sd_f is less or equal than sd_w, the output must be msf. Else, it must return msf minus the difference between sd_f and sd_week divided by 2. msf_sc can only be computed if alarm_f is equal to FALSE (the function will return NA when alarm_f == TRUE).</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="co"># msf_sc applies a correction to msf, removing an estimation of the effect from accumulated sleep debt on workdays that usually is compensated on work-free days. See ?msf_sc to learn more.</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>data.panel.custom<span class="sc">$</span>msf_sc <span class="ot">&lt;-</span> mctq<span class="sc">::</span><span class="fu">msf_sc</span>(data.panel.custom<span class="sc">$</span>msf, data.panel.custom<span class="sc">$</span>sd_w, data.panel.custom<span class="sc">$</span>sd_f, data.panel.custom<span class="sc">$</span>sd_week, </span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>                      data.panel.custom<span class="sc">$</span>alarm_f)</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>data.panel.custom.chrono <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">msf_sc_numeric =</span> <span class="fu">as.numeric</span>(msf_sc) <span class="sc">/</span> <span class="dv">3600</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid,msf_sc_numeric, msf_sc)  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(msf_sc_numeric))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="h2a-the-negative-association-between-late-night-gaming-and-sleep-quality-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2a-the-negative-association-between-late-night-gaming-and-sleep-quality-is-more-pronounced-among-evening-chronotypes.">H2a: The negative association between late-night gaming and sleep quality is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_6 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, psqi_6) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h2a by pid</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="co"># For psqi_6 1 means Very good, 2 means Fairly good, 3 means Fairly bad, 4 means Very bad</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a  <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_6_ord =</span> <span class="fu">factor</span>(psqi_6, <span class="at">ordered =</span> <span class="cn">TRUE</span>),  <span class="co"># Convert psqi_6 to an ordered factor</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2a by pid</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2a <span class="ot">&lt;-</span> data.gaming.latenight.h2a <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to fit the model and catch errors</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>fit_clmm_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    model.h2a <span class="ot">&lt;-</span> <span class="fu">clmm</span>(psqi_6_ord <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric <span class="sc">+</span> </span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>                      age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span> <span class="sc">|</span> gender),</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data.gaming.latenight.h2a)</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the model if it fits successfully</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(model.h2a)</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle the error: print a message and return NULL</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Error: Model failed to converge. Please check the model specification."</span>)</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>model.h2a <span class="ot">&lt;-</span> <span class="fu">fit_clmm_model</span>()</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the model was successfully fitted</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(model.h2a)) {</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modelsummary</span>(</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2a</span><span class="st">`</span> <span class="ot">=</span> model.h2a),</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="cn">NULL</span></span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print a message if the model did not fit</span></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Model summary was not generated due to convergence issues."</span>)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="h2b-the-negative-association-between-late-night-gaming-and-sleep-duration-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2b-the-negative-association-between-late-night-gaming-and-sleep-duration-is-more-pronounced-among-evening-chronotypes.">H2b: The negative association between late-night gaming and sleep duration is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data.panel <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data-synthetic/synPanel.rds"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert and compute</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_1_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_1</span><span class="st">`</span>), <span class="co"># Convert hours to numeric</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">psqi_4_1_1_2_hours =</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">psqi_4#1_1_2</span><span class="st">`</span>) <span class="sc">/</span> <span class="dv">60</span>, <span class="co"># Convert minutes to numeric hours</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_hours_sleep =</span> psqi_4_1_1_1_hours <span class="sc">+</span> psqi_4_1_1_2_hours, <span class="co"># Compute total hours of sleep</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, total_hours_sleep) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span> </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b  <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2b by pid</span></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2b <span class="ot">&lt;-</span> data.gaming.latenight.h2b <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>model.h2b <span class="ot">&lt;-</span> <span class="fu">lmer</span>(total_hours_sleep <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h2b )</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2b</span><span class="st">`</span> <span class="ot">=</span> model.h2b),</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_d6xmu386hqtghrbuyh8c(i, j, css_id) {
        var table = document.getElementById("tinytable_d6xmu386hqtghrbuyh8c");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_d6xmu386hqtghrbuyh8c');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_d6xmu386hqtghrbuyh8c(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_d6xmu386hqtghrbuyh8c");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(0, 0, 'tinytable_css_idculeatt9234rdze17vyj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(0, 1, 'tinytable_css_id75we8bjm9r6g893dxopu') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(1, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(1, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(2, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(2, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(3, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(3, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(4, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(4, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(5, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(5, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(6, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(6, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(7, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(7, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(8, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(8, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(9, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(9, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(10, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(10, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(11, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(11, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(12, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(12, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(13, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(13, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(14, 0, 'tinytable_css_idulofoxc0p7l2y9z16nuq') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(14, 1, 'tinytable_css_idpshpqyt4930t3hb80ipm') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(15, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(15, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(16, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(16, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(17, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(17, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(18, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(18, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(19, 0, 'tinytable_css_idjvu5wmfkf08hcbe78htj') })
window.addEventListener('load', function () { styleCell_d6xmu386hqtghrbuyh8c(19, 1, 'tinytable_css_idaheacha62hwm5igfvfd4') })
    </script>

    <style>
    .table td.tinytable_css_idculeatt9234rdze17vyj, .table th.tinytable_css_idculeatt9234rdze17vyj {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id75we8bjm9r6g893dxopu, .table th.tinytable_css_id75we8bjm9r6g893dxopu {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idjvu5wmfkf08hcbe78htj, .table th.tinytable_css_idjvu5wmfkf08hcbe78htj {  text-align: left; }
    .table td.tinytable_css_idaheacha62hwm5igfvfd4, .table th.tinytable_css_idaheacha62hwm5igfvfd4 {  text-align: center; }
    .table td.tinytable_css_idulofoxc0p7l2y9z16nuq, .table th.tinytable_css_idulofoxc0p7l2y9z16nuq {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idpshpqyt4930t3hb80ipm, .table th.tinytable_css_idpshpqyt4930t3hb80ipm {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_d6xmu386hqtghrbuyh8c" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H2b</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>6.82 [3.91, 9.73]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>-0.01 [-0.03, 0.02] </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                                </td>
                  <td>-0.04 [-0.07, 0.00]*</td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>0.11 [-0.16, 0.39]  </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>-0.03 [-0.22, 0.17] </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.04 [-0.24, 0.16] </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>0.03 [-0.24, 0.29]  </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.08 [-0.63, 0.47] </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played  msf_sc_numeric   </td>
                  <td>0.00 [0.00, 0.00]   </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>2.10                </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.01                </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>-1.00               </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>3.25                </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.98                </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>2448                </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.007               </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>13008.2             </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>13089.4             </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.72                </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h2c-the-negative-association-between-late-night-gaming-and-well-being-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2c-the-negative-association-between-late-night-gaming-and-well-being-is-more-pronounced-among-evening-chronotypes.">H2c: The negative association between late-night gaming and well-being is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- bind_rows(data.xbox.custom, data.steam.custom, data.nin.custom)</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minutes_played = as.numeric(difftime(sessionEnd, sessionStart, units = "mins")))</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(latenight = ifelse(hour(sessionStart) &gt;= 23 | hour(sessionStart) &lt; 6, 1, 0))</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(isWeekend = ifelse(weekdays(sessionStart) %in% c("Friday", "Saturday"), 1, 0))</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>data.gaming.h2c <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define biweekly waves (14-day intervals) that end at day 84</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">14</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">42</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">43</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">71</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Assign NA for days beyond 84</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.h2c <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, isWeekend) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">biweekly_avg_minutes_played =</span> <span class="fu">sum</span>(minutes_played)<span class="sc">/</span><span class="dv">14</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(biweekly_avg_minutes_played  <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1 - None of the time"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2 - Rarely"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3 - Some of the time"</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4 - Often"</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5 - All of the time"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>wemwbs_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wemwbs_1"</span>, <span class="st">"wemwbs_2"</span>, <span class="st">"wemwbs_3"</span>, <span class="st">"wemwbs_4"</span>, <span class="st">"wemwbs_5"</span>, <span class="st">"wemwbs_6"</span>, <span class="st">"wemwbs_7"</span>)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(wemwbs_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a wemwbs_total score for panel_balanced</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span>  data.panel.custom <span class="sc">%&gt;%</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wemwbs_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">all_of</span>(wemwbs_columns)))) </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, wemwbs_total) <span class="sc">%&gt;%</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight.h2c, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span> </span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c  <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2c by pid</span></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2c <span class="ot">&lt;-</span> data.gaming.latenight.h2c <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>model.h2c <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wemwbs_total <span class="sc">~</span> biweekly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric   <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> biweekly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled  <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender) , <span class="at">data =</span> data.gaming.latenight.h2c )</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model h2c</span><span class="st">`</span> <span class="ot">=</span> model.h2c),</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_7khe60qjlxjv73e6v9ks(i, j, css_id) {
        var table = document.getElementById("tinytable_7khe60qjlxjv73e6v9ks");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_7khe60qjlxjv73e6v9ks');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_7khe60qjlxjv73e6v9ks(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_7khe60qjlxjv73e6v9ks");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(0, 0, 'tinytable_css_idfz332qm5toe3pmlvuw50') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(0, 1, 'tinytable_css_idxkwqva122ukp33pbkgvo') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(1, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(1, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(2, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(2, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(3, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(3, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(4, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(4, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(5, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(5, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(6, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(6, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(7, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(7, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(8, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(8, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(9, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(9, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(10, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(10, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(11, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(11, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(12, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(12, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(13, 0, 'tinytable_css_idrg0ih0jqtxsg97gleazx') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(13, 1, 'tinytable_css_idjfivb2d5p569cj4q2qhh') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(14, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(14, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(15, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(15, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(16, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(16, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(17, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(17, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(18, 0, 'tinytable_css_idfdbqbskoslh463j0fnza') })
window.addEventListener('load', function () { styleCell_7khe60qjlxjv73e6v9ks(18, 1, 'tinytable_css_idvcalfhntxftaqfeeidu0') })
    </script>

    <style>
    .table td.tinytable_css_idfz332qm5toe3pmlvuw50, .table th.tinytable_css_idfz332qm5toe3pmlvuw50 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idxkwqva122ukp33pbkgvo, .table th.tinytable_css_idxkwqva122ukp33pbkgvo {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idfdbqbskoslh463j0fnza, .table th.tinytable_css_idfdbqbskoslh463j0fnza {  text-align: left; }
    .table td.tinytable_css_idvcalfhntxftaqfeeidu0, .table th.tinytable_css_idvcalfhntxftaqfeeidu0 {  text-align: center; }
    .table td.tinytable_css_idrg0ih0jqtxsg97gleazx, .table th.tinytable_css_idrg0ih0jqtxsg97gleazx {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idjfivb2d5p569cj4q2qhh, .table th.tinytable_css_idjfivb2d5p569cj4q2qhh {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_7khe60qjlxjv73e6v9ks" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model h2c</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                 </td>
                  <td>21.21 [16.13, 26.28]***</td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played                 </td>
                  <td>0.00 [-0.01, 0.01]     </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                              </td>
                  <td>-0.01 [-0.03, 0.01]    </td>
                </tr>
                <tr>
                  <td>age_scaled                                  </td>
                  <td>0.05 [-0.09, 0.19]     </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                  </td>
                  <td>0.04 [-0.06, 0.14]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                            </td>
                  <td>-0.01 [-0.12, 0.09]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                   </td>
                  <td>-0.01 [-0.22, 0.19]    </td>
                </tr>
                <tr>
                  <td>regionUS                                    </td>
                  <td>-0.14 [-0.43, 0.15]    </td>
                </tr>
                <tr>
                  <td>biweekly_avg_minutes_played  msf_sc_numeric</td>
                  <td>0.00 [0.00, 0.00]      </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                          </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>SD (biweekly_avg_minutes_played pid)        </td>
                  <td>0.02                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                       </td>
                  <td>5.78                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                           </td>
                  <td>3.61                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                    </td>
                  <td>5730                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                    </td>
                  <td>0.001                  </td>
                </tr>
                <tr>
                  <td>AIC                                         </td>
                  <td>31327.0                </td>
                </tr>
                <tr>
                  <td>BIC                                         </td>
                  <td>31420.1                </td>
                </tr>
                <tr>
                  <td>RMSE                                        </td>
                  <td>3.55                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="h2d-the-negative-association-between-late-night-gaming-and-daytime-sleepiness-is-more-pronounced-among-evening-chronotypes." class="level2">
<h2 class="anchored" data-anchor-id="h2d-the-negative-association-between-late-night-gaming-and-daytime-sleepiness-is-more-pronounced-among-evening-chronotypes.">H2d: The negative association between late-night gaming and daytime sleepiness is more pronounced among evening chronotypes.</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # merge xbox_balanced and steam_balanced and nin_balanced using bind_rows </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- bind_rows(data.xbox.custom, data.steam.custom, data.nin.custom)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # calculate minutes_played for data.gaming using sessionEnd and sessionStart</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(minutes_played = as.numeric(difftime(sessionEnd, sessionStart, units = "mins")))</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # create a binary variable for data.gaming called latenight if the sessionStart is between 23:00 and 06:00</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(latenight = ifelse(hour(sessionStart) &gt;= 23 | hour(sessionStart) &lt; 6, 1, 0))</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # create an isWeekend variable for data.gaming if the sessionStart is on a Saturday, Sunday or Friday</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># data.gaming &lt;- data.gaming %&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(isWeekend = ifelse(weekdays(sessionStart) %in% c("Friday", "Saturday"), 1, 0))</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># assign each session to a wave based on the date, if the date is within 4 weeks of the start of the study, it is wave 2, if it is between 4 weeks and 8 weeks it is wave 4, if it is between 8 weeks and 12 weeks it is wave 6</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data frame</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>data.gaming.h2d <span class="ot">&lt;-</span> data.gaming <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">wave =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">28</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">29</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">56</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>      day <span class="sc">&gt;=</span> <span class="dv">57</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wave))</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># group gaming by PID, wave and latenight and calculate daily average minutes_played</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight <span class="ot">&lt;-</span> data.gaming.h2d <span class="sc">%&gt;%</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pid, wave, isWeekend) <span class="sc">%&gt;%</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">sum</span>(latenight_gaming_minutes)<span class="sc">/</span><span class="dv">28</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(monthly_avg_minutes_played  <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a mapping of the string values to their numeric equivalents</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>value_mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No chance of dozing"</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Slight chance of dozing"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moderate chance of dozing"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"High chance of dozing"</span> <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify all columns whose names start with 'wemwbs'</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>eps_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"^eps"</span>, <span class="fu">names</span>(data.panel), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the mapping to these columns</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(eps_columns), <span class="sc">~</span> <span class="fu">as.numeric</span>(value_mapping[.])))</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate a eps_total score for panel_balanced</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>data.panel.custom <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eps_total =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(data.panel.custom, eps_columns)))</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a><span class="co"># select psqi_comp3 from panel_balanced and left_join to data.gaming.latenight by PID and wave</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.panel.custom <span class="sc">%&gt;%</span> <span class="fu">select</span>(pid, wave, eps_total) <span class="sc">%&gt;%</span> <span class="fu">filter</span> (wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.gaming.latenight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"pid"</span>, <span class="st">"wave"</span>))</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA with 0 in monthly_avg_minutes_played</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">monthly_avg_minutes_played =</span> <span class="fu">replace_na</span>(monthly_avg_minutes_played, <span class="dv">0</span>))</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.intake to data.gaming.latenight.h1a by pid</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> </span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data.intake, <span class="at">by =</span> <span class="st">"pid"</span>) <span class="sc">%&gt;%</span> <span class="co"># turn gender into a factor</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn gender into a factor</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender),</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate total height in inches</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_inches =</span> <span class="st">`</span><span class="at">height#1_1_1</span><span class="st">`</span> <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="st">`</span><span class="at">height#1_1_2</span><span class="st">`</span>,</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Calculate BMI using the formula</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> (weight <span class="sc">/</span> (total_inches<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">703</span>)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct SES</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to employment categories</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">empScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Full-Time"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Part-Time"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Due to start a new job within the next month"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Not in paid work (e.g. homemaker', 'retired or disabled)"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Unemployed (and job seeking)"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>      employment <span class="sc">==</span> <span class="st">"Other"</span> <span class="sc">~</span> <span class="cn">NA_real_</span> ,  <span class="co"># Adjust based on context if necessary</span></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assigning scores to education levels</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">eduScore =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Graduate or professional degree (MA, MS, MBA, PhD, etc)"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"University Bachelors Degree"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some University but no degree"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Vocational or Similar"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Secondary School"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Secondary"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Completed Primary School"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Some Primary"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a>      eduLevel <span class="sc">==</span> <span class="st">"Prefer not to say"</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,  <span class="co"># Treat as missing</span></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># Handle any other cases</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combining the scores into a SES index</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index =</span> empScore <span class="sc">+</span> eduScore</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d  <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid =</span> <span class="fu">as.factor</span>(pid)  <span class="co"># Convert pid to a factor</span></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale the covariates</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span></span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_scaled =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_scaled =</span> <span class="fu">scale</span>(bmi, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">SES_index_scaled =</span> <span class="fu">scale</span>(SES_index, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a><span class="co"># left join data.panel.custom.chrono to data.gaming.latenight.h2d by pid</span></span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>data.gaming.latenight.h2d <span class="ot">&lt;-</span> data.gaming.latenight.h2d <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(data.panel.custom.chrono, <span class="at">by =</span> <span class="st">"pid"</span>)</span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a>model.h2d <span class="ot">&lt;-</span> <span class="fu">lmer</span>(eps_total <span class="sc">~</span> monthly_avg_minutes_played<span class="sc">*</span>msf_sc_numeric <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> monthly_avg_minutes_played <span class="sc">|</span> pid) <span class="sc">+</span></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>              age_scaled <span class="sc">+</span> bmi_scaled <span class="sc">+</span> SES_index_scaled <span class="sc">+</span> isWeekend <span class="sc">+</span> region <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gender), <span class="at">data =</span> data.gaming.latenight.h2d )</span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model using modelsummary</span></span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">`</span><span class="at">Model H2d</span><span class="st">`</span> <span class="ot">=</span> model.h2d),</span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt =</span> <span class="dv">2</span>,</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate  =</span> <span class="st">"{estimate} [{conf.low}, {conf.high}]{stars}"</span>, </span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<!-- preamble start -->

    <script>
      function styleCell_2p3fjyw0emrq20w6tdpi(i, j, css_id) {
        var table = document.getElementById("tinytable_2p3fjyw0emrq20w6tdpi");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_2p3fjyw0emrq20w6tdpi');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_2p3fjyw0emrq20w6tdpi(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_2p3fjyw0emrq20w6tdpi");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(0, 0, 'tinytable_css_ide55nkseupoorl7z58m8w') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(0, 1, 'tinytable_css_id2i0ittu34zof5eliyi6c') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(1, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(1, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(2, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(2, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(3, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(3, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(4, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(4, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(5, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(5, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(6, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(6, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(7, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(7, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(8, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(8, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(9, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(9, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(10, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(10, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(11, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(11, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(12, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(12, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(13, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(13, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(14, 0, 'tinytable_css_idihnsmbdio88fwqz1zxyc') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(14, 1, 'tinytable_css_id4w72rgnj3ug4wluhf3yh') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(15, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(15, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(16, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(16, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(17, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(17, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(18, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(18, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(19, 0, 'tinytable_css_idayag5bdbz9fu6igfzutm') })
window.addEventListener('load', function () { styleCell_2p3fjyw0emrq20w6tdpi(19, 1, 'tinytable_css_id7fne5ulzdjwtjweccba9') })
    </script>

    <style>
    .table td.tinytable_css_ide55nkseupoorl7z58m8w, .table th.tinytable_css_ide55nkseupoorl7z58m8w {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id2i0ittu34zof5eliyi6c, .table th.tinytable_css_id2i0ittu34zof5eliyi6c {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idayag5bdbz9fu6igfzutm, .table th.tinytable_css_idayag5bdbz9fu6igfzutm {  text-align: left; }
    .table td.tinytable_css_id7fne5ulzdjwtjweccba9, .table th.tinytable_css_id7fne5ulzdjwtjweccba9 {  text-align: center; }
    .table td.tinytable_css_idihnsmbdio88fwqz1zxyc, .table th.tinytable_css_idihnsmbdio88fwqz1zxyc {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_id4w72rgnj3ug4wluhf3yh, .table th.tinytable_css_id4w72rgnj3ug4wluhf3yh {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_2p3fjyw0emrq20w6tdpi" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Model H2d</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                                   </td>
                  <td>12.03 [11.52, 12.54]***</td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played                    </td>
                  <td>0.02 [-0.01, 0.04]     </td>
                </tr>
                <tr>
                  <td>msf_sc_numeric                                </td>
                  <td>0.01 [-0.03, 0.04]     </td>
                </tr>
                <tr>
                  <td>age_scaled                                    </td>
                  <td>-0.08 [-0.32, 0.16]    </td>
                </tr>
                <tr>
                  <td>bmi_scaled                                    </td>
                  <td>0.02 [-0.15, 0.19]     </td>
                </tr>
                <tr>
                  <td>SES_index_scaled                              </td>
                  <td>-0.01 [-0.18, 0.17]    </td>
                </tr>
                <tr>
                  <td>isWeekend                                     </td>
                  <td>-0.01 [-0.26, 0.23]    </td>
                </tr>
                <tr>
                  <td>regionUS                                      </td>
                  <td>-0.12 [-0.60, 0.37]    </td>
                </tr>
                <tr>
                  <td>monthly_avg_minutes_played  msf_sc_numeric   </td>
                  <td>0.00 [0.00, 0.00]+     </td>
                </tr>
                <tr>
                  <td>SD (Intercept pid)                            </td>
                  <td>1.69                   </td>
                </tr>
                <tr>
                  <td>SD (monthly_avg_minutes_played pid)           </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>Cor (Intercept~monthly_avg_minutes_played pid)</td>
                  <td>1.00                   </td>
                </tr>
                <tr>
                  <td>SD (Intercept gender)                         </td>
                  <td>0.00                   </td>
                </tr>
                <tr>
                  <td>SD (Observations)                             </td>
                  <td>2.79                   </td>
                </tr>
                <tr>
                  <td>Num.Obs.                                      </td>
                  <td>2448                   </td>
                </tr>
                <tr>
                  <td>R2 Marg.                                      </td>
                  <td>0.003                  </td>
                </tr>
                <tr>
                  <td>AIC                                           </td>
                  <td>12597.6                </td>
                </tr>
                <tr>
                  <td>BIC                                           </td>
                  <td>12678.8                </td>
                </tr>
                <tr>
                  <td>RMSE                                          </td>
                  <td>2.57                   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>