---
title: "Study 1: Gaming and Basic Needs"
output: html_document
editor_options: 
  chunk_output_type: console
execute: 
  warning: false
page-layout: full
format:
  html:
    code-fold: true
    code-summary: "Show the code"
bibliography: references.bib
---

```{r}
#| label: load-libraries

if (!require("pacman")) install.packages("pacman"); library(pacman)

p_load(tidyverse, lme4, marginaleffects)

```

```{r}
#| label: load-data

diary <- read_csv("data-clean/synDiaryClean.csv") # requires that the preprocessing script has been run
intake <- read_csv("data-synthetic/synIntake.csv")
nin <- read_csv("data-synthetic/synNintendo.csv")
xbox <- read_csv("data-synthetic/synXbox.csv")
steam <- read_csv("data-synthetic/synXbox.csv")

```

```{r}
#| label: merge data

dat <- diary |> 
  left_join(intake |> select(pid, age, gender, eduLevel, employment), 
            by = "pid") |> 
  mutate(pid = as.character(pid))

```


## H1. Greater in-game need satisfaction is associated with greater global need satisfaction (H6 in BANG)

::: {.callout-note}
Hm. Something weird is happening here - there's a small but consistent negative relationship between gameNS_cw and globalNS, even though these variables have nothing to do with each other. I suspect this is a data issue, but I'm not sure what's going on.
:::

```{r}
#| label: h1-model

h1mod <- lmer(globalNS ~ gameNS_cw + gameNS_cb + age + gender + eduLevel + employment + (1 + gameNS_cw|pid), data = dat)

plot_predictions(h1mod, condition = "gameNS_cw")

```


## H2b. Situational need satisfaction is positively associated with higher likelihood of playing in the period after survey completion (H8 in BANG)

```{r}
#| label: h2a-model

# find out if people played across any console platform (nintendo xbox steam)

h2amod <- glmer(playedLaterAny ~ gameNS_cw + gameNS_cb + (1 + gameNS_cw|pid), 
               data = dat,
               family = binomial(link = "logit"))

plot_predictions(h2amod, condition = "globalNF_cw")

```



## H2b. Global need frustration is associated with higher likelihood of playing in the period after survey completion (H9 in BANG)

Here, I look at the relationship between global need frustration and the likelihood of playing after the survey. 

```{r}
#| label: h2b-model

h2bmod <- glmer(playedAfterSurvey ~ globalNF + (1 + globalNF|id), 
               data = dat,
               family = binomial(link = "logit"))

```


## H3. When gaming displaces a core life domain (work/school, social engagements, sleep/eating/fitness, or caretaking), global need satisfaction will be lower (H5 in BANG)

We don't have temporal precedence here (the need satisfaction measure refers to the day as a whole), and have very little ability to define and adjust for confounds, so this is a very weak test of the displacement hypothesis---but the first of its kind, as far as I know. 

Briefly, I'm just interested in whether gaming sessions that displace a core life domain---work/school, social engagements, sleep/eating/fitness, or caretaking---are associated with lower global need satisfaction. `displacedCoreActivity` is a binary variable; participants write in a free text response what they most likely would have done instead of their most recent gaming session, and these are classified into core/noncore domains. 

```{r}
#| label: h3-model

table(dat$displacedCoreDomain)
h3mod <- lmer(globalNS ~ displacedCoreDomain + (1 + displacedCoreDomain|id), data = dat)

```
